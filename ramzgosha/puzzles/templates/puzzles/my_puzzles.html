{% extends 'puzzles/base.html' %}

{% block content %}
<div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
    <a href="{% url 'home' %}" style="font-size: 1.5rem; color: white;">&#8594;</a>
    <h2 style="margin: 0;">معماهای ساخته شده توسط من</h2>
    <a href="{% url 'create_puzzle' %}" style="color: #e0b0ff; text-decoration: none; font-size: 1.5rem;">+</a>
</div>

<div style="background: #16213e; border-radius: 12px; padding: 15px; border: 2px solid #fff;">
    <table style="width: 100%; text-align: right; border-collapse: collapse; color: white;">
        <thead>
            <tr style="border-bottom: 2px solid #555;">
                <th style="padding: 10px;">ردیف</th>
                <th style="padding: 10px;">متن معما</th>
                <th style="padding: 10px; text-align: center;">وضعیت</th>
                <th style="padding: 10px; text-align: left;">عملیات</th>
            </tr>
        </thead>
        <tbody>
            {% for p in page_obj %}
            <tr style="border-bottom: 1px solid #333; transition: background 0.2s;">
                <td style="padding: 15px 10px;">{{ forloop.counter }}</td>
                <td style="padding: 15px 10px; font-size: 0.9rem;">{{ p.clue_text|truncatechars:40 }}</td>
                <td style="padding: 15px 10px; text-align: center;">
                    {% if p.is_verified %}
                        <span style="background: #4caf50; padding: 3px 8px; border-radius: 10px; font-size: 0.8rem;">تایید شده</span>
                        <div style="font-size: 0.7rem; margin-top: 5px; color: #aaa;">انتشار: {{ p.publish_date|date:"j F Y" }}</div>
                    {% else %}
                        <span style="background: #ff9800; padding: 3px 8px; border-radius: 10px; font-size: 0.8rem;">در انتظار بررسی</span>
                    {% endif %}
                </td>
                <td style="padding: 15px 10px; text-align: left;">
                    <a href="{% url 'play_private' p.id %}" style="background: rgba(255,255,255,0.1); color: #fff; text-decoration: none; padding: 5px 10px; border-radius: 5px; font-size: 0.9rem;">
                        تست / بازی
                    </a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="4" style="text-align: center; padding: 30px;">شما هنوز معمایی طراحی نکرده‌اید!</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <div style="margin-top: 20px; text-align: center; color: #a0a0a0;">
        {% if page_obj.has_previous %}
            <a href="?page={{ page_obj.previous_page_number }}" style="color: #e0b0ff; margin-left: 10px;">&#8594; قبلی</a>
        {% endif %}

        <span>صفحه {{ page_obj.number }} از {{ page_obj.paginator.num_pages }}</span>

        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}" style="color: #e0b0ff; margin-right: 10px;">بعدی &#8592;</a>
        {% endif %}
    </div>
</div>
{% endblock %}