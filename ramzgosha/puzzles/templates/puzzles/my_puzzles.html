{% extends 'puzzles/base.html' %}
{% load jalali_tags %} {% block content %}
<style>
    .page-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 25px;
    }

    /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù„ÛŒØ³Øª Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ (Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ø¬Ø¯ÙˆÙ„) */
    .puzzle-list {
        display: flex;
        flex-direction: column;
        gap: 15px;
    }

    .puzzle-card {
        background: #16213e;
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 16px;
        padding: 20px;
        display: flex;
        flex-direction: column;
        gap: 15px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        transition: transform 0.2s, box-shadow 0.2s;
    }
    .puzzle-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 16px rgba(0,0,0,0.4);
        border-color: rgba(79, 195, 247, 0.3);
    }

    .card-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        gap: 10px;
    }

    .clue-text {
        font-size: 1.1rem;
        font-weight: bold;
        color: #fff;
        line-height: 1.6;
        margin: 0;
        flex: 1;
    }

    /* Ø§Ø³ØªØ§ÛŒÙ„ Ù†Ø´Ø§Ù†â€ŒÙ‡Ø§ÛŒ ÙˆØ¶Ø¹ÛŒØª (Badges) */
    .badge {
        padding: 4px 10px;
        border-radius: 20px;
        font-size: 0.75rem;
        font-weight: bold;
        white-space: nowrap;
    }
    .badge-verified {
        background: rgba(76, 175, 80, 0.15);
        color: #4caf50;
        border: 1px solid #4caf50;
    }
    .badge-pending {
        background: rgba(255, 152, 0, 0.15);
        color: #ff9800;
        border: 1px solid #ff9800;
    }

    .card-footer {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-top: 1px dashed #444;
        padding-top: 15px;
        margin-top: 5px;
    }

    .card-date {
        font-size: 0.85rem;
        color: #a0a0a0;
    }

    .play-btn {
        background: rgba(79, 195, 247, 0.1);
        color: #4fc3f7;
        border: 1px solid #4fc3f7;
        padding: 6px 15px;
        border-radius: 20px;
        text-decoration: none;
        font-size: 0.85rem;
        font-weight: bold;
        transition: background 0.2s;
    }
    .play-btn:hover { background: rgba(79, 195, 247, 0.3); }

    /* Ø§Ø³ØªØ§ÛŒÙ„ ØµÙØ­Ù‡â€ŒØ¨Ù†Ø¯ÛŒ (Pagination) */
    .pagination {
        margin-top: 30px;
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 15px;
        color: #a0a0a0;
        font-size: 0.9rem;
    }
    .page-btn {
        background: rgba(255, 255, 255, 0.05);
        color: #fff;
        border: 1px solid #555;
        padding: 6px 15px;
        border-radius: 20px;
        text-decoration: none;
        transition: all 0.2s;
    }
    .page-btn:hover { background: rgba(255, 255, 255, 0.1); border-color: #fff; }
</style>

<div class="page-header">
    <a href="{% url 'home' %}" style="font-size: 1.5rem; color: white; text-decoration: none;">&#8594;</a>
    <h2 style="margin: 0; font-size: 1.3rem;">Ù…Ø¹Ù…Ø§Ù‡Ø§ÛŒ Ø³Ø§Ø®ØªÙ‡ Ø´Ø¯Ù‡ ØªÙˆØ³Ø· Ù…Ù†</h2>

    <a href="{% url 'create_puzzle' %}" style="color: #4fc3f7; text-decoration: none; font-size: 1.5rem; background: rgba(79, 195, 247, 0.1); width: 35px; height: 35px; display: flex; align-items: center; justify-content: center; border-radius: 50%; border: 1px solid #4fc3f7;" title="Ø·Ø±Ø§Ø­ÛŒ Ù…Ø¹Ù…Ø§ÛŒ Ø¬Ø¯ÛŒØ¯">
        +
    </a>
</div>

<div class="puzzle-list">
    {% for p in page_obj %}
    <div class="puzzle-card">
        <div class="card-header">
            <p class="clue-text">{{ p.clue_text }} ({{ p.answer_length }})</p>

            {% if p.is_verified %}
                <span class="badge badge-verified">ØªØ§ÛŒÛŒØ¯ Ø´Ø¯Ù‡ âœ“</span>
            {% else %}
                <span class="badge badge-pending">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø± â³</span>
            {% endif %}
        </div>

        <div class="card-footer">
            <div class="card-date">
                {% if p.is_verified %}
                    ğŸ“… Ø§Ù†ØªØ´Ø§Ø±: {{ p.publish_date|to_jalali }}
                {% else %}
                    âœï¸ Ø§ÛŒØ¬Ø§Ø¯: {{ p.date|to_jalali }}
                {% endif %}
            </div>
            <div style="display: flex; gap: 8px;">
                {% if not p.is_verified %}
                    <a href="{% url 'edit_puzzle' p.id %}" class="play-btn" style="border-color: #ffca28; color: #ffca28;">ÙˆÛŒØ±Ø§ÛŒØ´ / Ø­Ø°Ù âœï¸</a>
                {% endif %}
                    <a href="{% url 'play_private' p.id %}" class="play-btn">ØªØ³Øª / Ø¨Ø§Ø²ÛŒ</a>
            </div>
        </div>
    </div>
    {% empty %}
    <div style="text-align: center; padding: 40px 20px; background: #16213e; border-radius: 16px; border: 1px dashed #555;">
        <div style="font-size: 3rem; margin-bottom: 15px;">ğŸ§©</div>
        <h3 style="color: #fff; margin-bottom: 10px;">Ù‡Ù†ÙˆØ² Ù…Ø¹Ù…Ø§ÛŒÛŒ Ù†Ø³Ø§Ø®ØªÛŒ!</h3>
        <p style="color: #a0a0a0; margin-bottom: 20px;">Ø§ÙˆÙ„ÛŒÙ† Ù…Ø¹Ù…Ø§ÛŒ Ø®ÙˆØ¯Øª Ø±Ùˆ Ø·Ø±Ø§Ø­ÛŒ Ú©Ù† ØªØ§ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø¨Ø´Ù‡.</p>
        <a href="{% url 'create_puzzle' %}" class="play-btn" style="display: inline-block;">+ Ø·Ø±Ø§Ø­ÛŒ Ù…Ø¹Ù…Ø§ÛŒ Ø¬Ø¯ÛŒØ¯</a>
    </div>
    {% endfor %}
</div>

{% if page_obj.paginator.num_pages > 1 %}
<div class="pagination">
    {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}" class="page-btn">Ø¨Ø¹Ø¯ÛŒ &#8592;</a>
    {% else %}
        <span style="opacity: 0.3; padding: 6px 15px; border: 1px solid #555; border-radius: 20px;">Ø¨Ø¹Ø¯ÛŒ &#8592;</span>
    {% endif %}

    <span>ØµÙØ­Ù‡ {{ page_obj.number }} Ø§Ø² {{ page_obj.paginator.num_pages }}</span>

    {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}" class="page-btn">&#8594; Ù‚Ø¨Ù„ÛŒ</a>
    {% else %}
        <span style="opacity: 0.3; padding: 6px 15px; border: 1px solid #555; border-radius: 20px;">&#8594; Ù‚Ø¨Ù„ÛŒ</span>
    {% endif %}
</div>
{% endif %}
{% endblock %}